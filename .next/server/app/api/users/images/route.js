(()=>{var e={};e.id=686,e.ids=[686],e.modules={62849:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62849,e.exports=t},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},68621:e=>{"use strict";e.exports=require("punycode")},86624:e=>{"use strict";e.exports=require("querystring")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},95346:e=>{"use strict";e.exports=require("timers")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},6005:e=>{"use strict";e.exports=require("node:crypto")},89064:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>E,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{GET:()=>c});var i=r(49303),o=r(88716),a=r(60670),u=r(62458);let n=new(r(33064)).lv(process.env.GOOGLE_CLIENT_ID);async function c(e){try{let t=e.nextUrl.searchParams,r=e.headers.get("Authorization"),s=r?.split(" ")[1];if(!s)return Response.json({message:"Unauthorized"},{status:401});let i=await new Promise(async e=>{try{let t=(await n.verifyIdToken({idToken:s||"",audience:process.env.GOOGLE_CLIENT_ID})).getPayload();e(t&&void 0!==t?t:null)}catch(t){e(null)}});if(!i)return Response.json({message:"Unauthorized"},{status:401});let o=parseInt(t.get("page")||"1"),a=parseInt(t.get("entries")||"50"),c=await (0,u.U2)(["SELECT * FROM images WHERE sub = ? ORDER BY created_at DESC LIMIT ? OFFSET ?",[i.sub,a,(o-1)*a]]);if(!(Array.isArray(c)&&c.length>0))return Response.json({totalPage:0,images:[]});c=c.map(e=>(e.id=null,e));let p=await (0,u.U2)("SELECT COUNT(*) AS count FROM images"),l=Array.isArray(p)?p[0].count:0,d=Math.ceil(l/a);return Response.json({totalPage:d,images:c})}catch(e){return Response.json({message:"Failed to get images",error:e.message},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/users/images/route",pathname:"/api/users/images",filename:"route",bundlePath:"app/api/users/images/route"},resolvedPagePath:"C:\\Users\\Chelovek\\Desktop\\website.online\\picxob.borislukrece.pro\\src\\app\\api\\users\\images\\route.tsx",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m}=p,E="/api/users/images/route";function g(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},62458:(e,t,r)=>{"use strict";r.d(t,{U2:()=>n,v_:()=>c});var s=r(36352),i=r(73785);let o=(0,s.uj)(),a=(0,i.createPool)({host:o.DB_HOST,user:o.DB_USER,password:o.DB_PASSWORD,database:o.DB_NAME,waitForConnections:!0,connectionLimit:10,queueLimit:0});async function u(e,t){let r="",s=[];switch("string"==typeof e?r=e:Array.isArray(e)&&(r=e[0],s=e[1]||[]),t){case"get":if(!r.startsWith("SELECT"))throw Error("Invalid SQL statement");break;case"post":if(!r.startsWith("INSERT INTO"))throw Error("Invalid SQL statement");break;case"update":if(!r.startsWith("UPDATE"))throw Error("Invalid SQL statement");break;case"delete":if(!r.startsWith("DELETE"))throw Error("Invalid SQL statement")}let[i]=await a.query(r,s);return i}async function n(e){return await u(e,"get")}async function c(e,t=null){let r=await u(e,"post");return await new Promise(async e=>{try{if(t){let s=await n([`SELECT * FROM ${t} WHERE id = ? LIMIT 1`,[r.insertId]]);Array.isArray(s)&&s.length>0&&e(s[0])}else e(null)}catch(t){console.log("Error getting item added: ",t.message),e(null)}})}},36352:(e,t,r)=>{"use strict";r.d(t,{DO:()=>i,FX:()=>o,uj:()=>a});var s=r(9576);function i(){let e=(0,s.Z)();return`${e}`}function o(){return"https://picxob.borislukrece.com"}function a(){return{DB_HOST:process.env.DB_HOST,DB_USER:process.env.DB_USER,DB_NAME:process.env.DB_NAME,DB_PASSWORD:process.env.DB_PASSWORD}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,398,64],()=>r(89064));module.exports=s})();